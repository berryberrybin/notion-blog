---
---

<div class="theme-controls">
  <!-- Dark Mode Toggle -->
  <button id="theme-toggle" class="theme-btn" aria-label="Toggle dark mode">
    <span class="btn-text light-text">Light</span>
    <span class="btn-text dark-text">Dark</span>
  </button>

  <!-- Simple Mode Toggle -->
  <button id="simple-toggle" class="theme-btn simple-btn" aria-label="Toggle simple mode">
    <span class="btn-text">Simple</span>
  </button>
</div>

<script>
  function initTheme() {
    const themeToggle = document.getElementById("theme-toggle");
    const simpleToggle = document.getElementById("simple-toggle");

    const getTheme = () => {
      const stored = localStorage.getItem("theme");
      if (stored) return stored;
      return window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light";
    };

    const setTheme = (theme: string) => {
      document.documentElement.setAttribute("data-theme", theme);
      localStorage.setItem("theme", theme);
      updateToggles(theme);
    };

    const updateToggles = (theme: string) => {
      const isDark = theme === "dark" || theme === "simple-dark";
      const isSimple = theme === "simple" || theme === "simple-dark";

      themeToggle?.classList.toggle("is-dark", isDark);
      simpleToggle?.classList.toggle("active", isSimple);
    };

    // Initialize theme
    const currentTheme = getTheme();
    setTheme(currentTheme);

    // Handle light/dark toggle click
    themeToggle?.addEventListener("click", () => {
      const current = document.documentElement.getAttribute("data-theme");
      let next: string;

      if (current === "light") {
        next = "dark";
      } else if (current === "dark") {
        next = "light";
      } else if (current === "simple") {
        next = "simple-dark";
      } else if (current === "simple-dark") {
        next = "simple";
      } else {
        next = "dark";
      }

      themeToggle.classList.add("clicked");
      setTimeout(() => themeToggle.classList.remove("clicked"), 200);
      setTheme(next);
    });

    // Handle simple mode toggle click
    simpleToggle?.addEventListener("click", () => {
      const current = document.documentElement.getAttribute("data-theme");
      let next: string;

      if (current === "light") {
        next = "simple";
      } else if (current === "dark") {
        next = "simple-dark";
      } else if (current === "simple") {
        next = "light";
      } else if (current === "simple-dark") {
        next = "dark";
      } else {
        next = "simple";
      }

      simpleToggle.classList.add("clicked");
      setTimeout(() => simpleToggle.classList.remove("clicked"), 200);
      setTheme(next);
    });
  }

  // Run on initial load
  initTheme();

  // Re-run on view transitions
  document.addEventListener("astro:after-swap", initTheme);
</script>

<style>
  .theme-controls {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .theme-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    border: 1px solid var(--border-color);
    cursor: pointer;
    padding: 0.375rem 0.75rem;
    height: 32px;
    color: var(--text-muted);
    border-radius: 6px;
    transition: all 0.15s ease;
    font-size: 0.75rem;
    font-weight: 500;
    letter-spacing: 0.01em;
  }

  .theme-btn:hover {
    border-color: var(--text-muted);
    color: var(--text-color);
  }

  .theme-btn:active,
  .theme-btn.clicked {
    transform: scale(0.95);
  }

  .btn-text {
    transition: opacity 0.15s ease;
  }

  /* Light/Dark toggle text visibility */
  .light-text {
    display: inline;
  }

  .dark-text {
    display: none;
  }

  .theme-btn.is-dark .light-text {
    display: none;
  }

  .theme-btn.is-dark .dark-text {
    display: inline;
  }

  /* Simple Toggle - active state */
  .simple-btn.active {
    background: var(--text-color);
    border-color: var(--text-color);
    color: var(--bg-color);
  }

  .simple-btn.active:hover {
    opacity: 0.9;
  }
</style>